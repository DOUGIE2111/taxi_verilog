# Verilog实验出租车计费系统

![image-20230923001317841](C:\Users\86182\Desktop\pit\image-20230923001317841.png)

## 1.ms时钟

### 1.1算式

​       我们的目标是获得**1000hz**的数值，得到**ms**的标准周期，1/1000 = 1ms。

​		50Mhz的时钟周期 = 50_000_000;

​        总时钟/目标频率/2 =  分频系数

  	 计数值 = 分频系数 - 1；
       
$$
50 000 000/1000/2 = 25000
$$

### 1.2代码解析

​		clk为输入时钟，f为输出的二进制的值，因为***脉冲***为0，1变化的脉冲也就和二进制数一样。

​		输出的f为1000hz的标准ms时钟频率。

![image-20230923000210836](C:\Users\86182\Desktop\pit\image-20230923000210836.png)

# 2.控制模块

### 2.1解析

 		Q为控制端，我用的拨动开关的引脚，按上接地为0，而没有拨下为1，当为0时候输入的总时钟50Mhz赋值给 **I** ,**I**为输出的值，为1就赋值0，也就没有时钟输出。

#### 		![image-20230923001527888](C:\Users\86182\Desktop\pit\image-20230923001527888.png)



# 3.计费模块

​		输入的时钟为clk，此脉冲为1000hz的输出f，gongli为公里值，下面有解析就不过多解释了，要记住就是50之后的关键点，50之后的时间和公里需要考虑进去。
​		**yuan、gongli 、dengdai** 的值我**扩大了*10*倍**方便后面算位。

![image-20230923000135842](C:\Users\86182\Desktop\pit\image-20230923000135842.png)

# 4.算位

### 1.1代码解析

​		因为数码管是0-9，所有钱和公里，等待时间我们要化成个位、十位、百位、千位这样来做。

![image-20230923002202475](C:\Users\86182\Desktop\pit\image-20230923002202475.png)

# 5.数码管刷新率

### 1.1代码解析

​		看代码注释，500hz的总频率/8 = 62.2......hz

​		  ![image-20230923002643176](C:\Users\86182\Desktop\pit\image-20230923002643176.png)

![image-20230923002536175](C:\Users\86182\Desktop\pit\image-20230923002536175.png)

# 6.点亮数码管

### 1.1代码解析

​		**d**为切换显示按键，当按下为0，因为只需要显示2位所以，110和111时候位1111_1111，全1也就不亮，其它情况的时候，每次点亮一个，依次点亮，可以看到0**依次向后移位**。

![image-20230923002848051](C:\Users\86182\Desktop\pit\image-20230923002848051.png)

# 7.数码管数字

### 1.1代码解析

​		，输入的sel也就是**suanwei**的输出值（个位十位百位千位），因为数码管有八个也就是 0 - 7，钱占4位数码管，0-3，所以我门要让第3个数码管的小数点点亮，111.1这样的效果，可以看到代码3'd2的时候第一位都是0，也就是小数点的段码为0，让小数点常量，后面的公里也是050.1这样所有d6的时候也点亮。输入sel

![image-20230923003207996](C:\Users\86182\Desktop\pit\image-20230923003207996.png)

# 8.数码管数字和算位结合

​		**input**中4个位宽的都为**等待**和**钱**和**公里**的个位十位百位......
​		d为切换显示，切换按下就让4，5的数据变为等待的个位十位。

![image-20230923003855929](C:\Users\86182\Desktop\pit\image-20230923003855929.png)



# 9.按键计费

### 1.1看注释就行，其中b,c为给led灯的，当等待或者公里数值增加一次，b，c赋值的led就闪烁一次，便于观测，可以删取

![image-20230923004147603](C:\Users\86182\Desktop\pit\image-20230923004147603.png)